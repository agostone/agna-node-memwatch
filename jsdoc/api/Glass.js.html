<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Glass.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Glass.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * @module agna-gulp-glass
 *
 * @todo lazy loading tasks only when they are required (a possible speed enhancement?)
 */

// Privates vars
var _ = require('lodash');
var _Glob = require('glob');
var _Gulp = require('gulp');
var _Path = require('path');

var _instance = void 0;

/**
 * Constructor
 *
 * @class
 * @param {Object} configuration
 * @returns {Glass}
 */
function Glass(configuration) {

  // Making it a singleton, while making it possible to extend Glass via prototype.
  // No mater if you call new Glass() or Glass(), you'll get the same instance back.
  if (_instance === void 0) {
    if (!(this instanceof Glass)) {
      new Glass(configuration);
    } else {

      // Public vars
      this.taskPaths = [];
      this.pattern = '**/*.js';

      if (_.isString(configuration)) {
        this.taskPaths = [configuration];
      } else if (_.isPlainObject(configuration)){
        if (_.isString(configuration.taskPaths)) {
          this.taskPaths = [configuration.taskPaths];
        }

        if (_.isArray(configuration.taskPaths)) {
          this.taskPaths = configuration.taskPaths;
        }

        if (_.isString(configuration.pattern)) {
          this.pattern = configuration.pattern;
        }
      }

      _instance = this;
    }
  }

  return _instance;
}

/**
 * Loads all gulp tasks
 *
 * @returns {Gulp}
 */
Glass.prototype.loadTasks = function() {

  // Cycling through task paths
  this.taskPaths.forEach(function (path) {
    var files = _Glob.sync(this.pattern, { cwd: path });

    // Cycling through files inside the task path
    files.forEach(function (file) {

      var task = require(_Path.join(_Path.resolve(path), file));
      var args = [_Path.basename(file, _Path.extname(file))];

      if (_.isArray(task.deps)) {
        args.push(task.deps);
      }

      args.push(this.decorate(args[0], task));

      _Gulp.task.apply(_Gulp, args);
    }, this);
  }, this);

  return _Gulp;
}

/**
 * Override this method to apply any decorator logic to the task function.
 *
 * @param {String} taskName
 * @param {Function} taskFunction
 * @returns {Function}
 */
Glass.prototype.decorate = function (taskName, taskFunction) {
  return taskFunction;
}

/**
 * Exports the Glass class, to get a glass instance see the examples below.
 *
 * @example var instance = (require('agna-gulp-glass'))(configuration);
 * @example var Glass = require('agna-gulp-glass'); var instance = Glass(configuration);
 * @example var Glass = require('agna-gulp-glass'); var instance = new Glass(configuration);
 */
module.exports = Glass;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-agna-gulp-glass.html">agna-gulp-glass</a></li></ul><h3>Classes</h3><ul><li><a href="module-agna-gulp-glass-Glass.html">Glass</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Apr 25 2016 15:45:33 GMT+0200 (Central Europe Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
